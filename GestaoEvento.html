<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gestão de Evento</title>

  <link rel="stylesheet" href="assets/menu-styles.css" />
  <link rel="stylesheet" href="assets/base.css" />

  <style>
    :root{
      --accent:#ff7f00;
      --card-bg:#fff8ef;
      --line:#e9e9e9;
      --muted:#6b7280;
    }

    .main-content{padding-top:8px}
    h2{margin:6px 0 6px}

    /* ===== Topo (linha com evento/data/responsável/status) ===== */
    .topbar{
      display:grid;
      grid-template-columns: 1.1fr repeat(3, .7fr);
      gap:6px;
      margin-bottom:4px;
      align-items:end;
    }

    /* Campos com rótulo padronizado */
    .field{display:flex; flex-direction:column; gap:2px}
    .field label{font-size:11px; color:#4b5563}
    .field input,.field select{
      border:1px solid #ddd;border-radius:8px;padding:3px 6px;font-size:12.5px;height:26px
    }
    .field input[disabled]{background:#f6f6f6}

    /* Linha com Venda PDV / CMV / Previsão */
    .row2{
      display:grid;grid-template-columns: repeat(3, 1fr);
      gap:6px; margin:4px 0 6px 0;
    }

    /* ===== Cards Totais ===== */
    .section-title{font-weight:700;font-size:13px;margin:6px 0 6px;color:#000}
    .card-grid{display:grid;grid-template-columns: repeat(4, minmax(180px,1fr));gap:6px;margin-bottom:6px}
    @media (max-width:1150px){ .card-grid{grid-template-columns: repeat(2,1fr)} }
    @media (max-width:640px){ .card-grid{grid-template-columns: 1fr} }

    .kcard{
      background:var(--card-bg);
      border:1px solid var(--line);
      border-left:2px solid var(--accent);
      border-radius:10px;
      padding:5px 7px;
      display:flex;flex-direction:column;gap:1px;min-height:46px;
    }
    .kcard .label{font-size:10.5px;color:#4b5563;line-height:1.1}
    .kcard .value{font-size:15px;font-weight:800;color:var(--accent);line-height:1.05}

    /* ===== Blocos Equipe/Logística/Produtos ===== */
    .cols-2{display:grid; grid-template-columns: 1fr 1fr; gap:10px}
    @media (max-width:900px){ .cols-2{grid-template-columns:1fr} }
    .box{border:1px solid var(--line);border-radius:10px;padding:8px;background:#fff}

    .row{display:flex;gap:6px;align-items:center}
    .mb-2{margin-bottom:6px}
    .form-select, .form-control{
      width:100%; border:1px solid #ddd; border-radius:8px; padding:3px 6px; height:26px; font-size:12.5px;
    }
    .btn{background:#198754;color:#fff;border:none;border-radius:8px;height:26px;padding:0 10px;cursor:pointer;font-size:12.5px}
    .btn:hover{background:#146c43}
    .btn-danger{background:#e11d48}.btn-danger:hover{background:#be123c}
    .btn-cinza{background:#f3f4f6;color:#111827;border:1px solid #e5e7eb}
    .btn-cinza:hover{background:#e5e7eb}

    /* ===== Tabela Produtos ===== */
    table{width:100%;border-collapse:collapse;font-size:12.5px;table-layout:fixed}
    thead th{background:var(--accent);color:#fff;padding:6px;text-align:left}
    tbody td{border-bottom:1px solid #f0f0f0;padding:4px 6px}
    #tabelaProdutos input{height:24px}
    #tabelaProdutos td input[type="number"],
    #tabelaProdutos td:nth-child(n+2):nth-child(-n+7) input{ text-align:right; }
    #tabelaProdutos td:first-child input{
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis; text-transform:uppercase;
    }

    .form-actions{display:flex;justify-content:flex-end;margin-top:8px}
  </style>

  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <script src="assets/menu.js" defer></script>
</head>
<body>
  <div class="layout">
    <aside class="sidebar" id="menuLateral"></aside>

    <main class="main-content">
      <h2>Gestão de Evento</h2>

      <form id="formGestaoEvento">
        <!-- Linha 1: seleção principal -->
        <div class="topbar">
          <div class="field">
            <label for="nomeEvento">Evento</label>
            <select id="nomeEvento" required></select>
          </div>
          <div class="field">
            <label for="data">Data</label>
            <input type="date" id="data" required>
          </div>
          <div class="field">
            <label for="responsavel">Responsável</label>
            <select id="responsavel" required></select>
          </div>
          <div class="field">
            <label for="status">Status</label>
            <select id="status" required>
              <option value="Aberto">Aberto</option>
              <option value="Finalizado">Finalizado</option>
              <option value="Fechado">Fechado</option>
            </select>
          </div>
        </div>

        <!-- Linha 2: números com rótulo no mesmo padrão -->
        <div class="row2">
          <div class="field">
            <label for="vendaPDV">Venda PDV</label>
            <input type="number" id="vendaPDV" step="0.01" oninput="calcularTotais()">
          </div>
          <div class="field">
            <label for="cmvReal">CMV (calculado sobre PDV)</label>
            <input type="number" id="cmvReal" step="0.01" disabled>
          </div>
          <div class="field">
            <label for="estimativaVenda">Previsão de Venda</label>
            <input type="number" id="estimativaVenda" step="0.01" oninput="calcularTotais()">
          </div>
        </div>

        <!-- Totais -->
        <h3 class="section-title">Totais do Evento</h3>
        <div class="card-grid">
          <div class="kcard"><div class="label">Venda Sistema</div><div class="value">R$ <span id="vendaSistema">0.00</span></div></div>
          <div class="kcard"><div class="label">Diferença PDV − Sistema</div><div class="value">R$ <span id="diferencaVenda">0.00</span></div></div>
          <div class="kcard"><div class="label">Lucro Final</div><div class="value">R$ <span id="lucroFinal">0.00</span></div></div>
          <div class="kcard"><div class="label">Custo Perda</div><div class="value">R$ <span id="custoPerda">0.00</span></div></div>

          <div class="kcard"><div class="label">Valor Assados</div><div class="value">R$ <span id="valorAssados">0.00</span></div></div>
          <div class="kcard"><div class="label">Custo Logística</div><div class="value">R$ <span id="custoLogistica">0.00</span></div></div>
          <div class="kcard"><div class="label">Custo Equipe</div><div class="value">R$ <span id="custoEquipe">0.00</span></div></div>
          <div class="kcard"><div class="label">Potencial de Venda</div><div class="value">R$ <span id="potencialVenda">0.00</span></div></div>
        </div>

        <!-- Equipe / Logística -->
        <div class="cols-2">
          <div class="box">
            <h3 class="section-title">Equipe</h3>
            <div id="equipeContainer"></div>
            <button type="button" id="btnEquipe" onclick="adicionarEquipe()" class="btn btn-cinza" disabled>+ Adicionar Equipe</button>
          </div>

          <div class="box">
            <h3 class="section-title">Logística</h3>
            <div id="logisticaContainer"></div>
            <button type="button" id="btnLogistica" onclick="adicionarLogistica()" class="btn btn-cinza" disabled>+ Adicionar Logística</button>
          </div>
        </div>

        <!-- Produtos -->
        <div class="box" style="margin-top:8px;">
          <h3 class="section-title">Produtos</h3>
          <div class="row mb-2">
            <button type="button" onclick="adicionarProduto()" class="btn btn-cinza">+ Adicionar Produto</button>
          </div>

          <table>
            <colgroup>
              <col style="width: 280px;">   <!-- Produto -->
              <col style="width: 80px;">    <!-- Qtd Enviada -->
              <col style="width: 70px;">    <!-- Média -->
              <col style="width: 80px;">    <!-- Congelado -->
              <col style="width: 80px;">    <!-- Assado -->
              <col style="width: 80px;">    <!-- Perda -->
              <col style="width: 90px;">    <!-- Qtd Vendida -->
              <col style="width: 120px;">   <!-- Valor Venda -->
              <col style="width: 120px;">   <!-- Valor Perda -->
              <col style="width: 60px;">    <!-- Ações -->
            </colgroup>

            <thead>
              <tr>
                <th>Produto</th>
                <th>Qtd Enviada</th>
                <th>Média</th>
                <th>Congelado</th>
                <th>Assado</th>
                <th>Perda</th>
                <th>Qtd Vendida</th>
                <th>Valor Venda</th>
                <th>Valor Perda</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody id="tabelaProdutos"></tbody>
          </table>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn">Salvar Evento</button>
        </div>
      </form>

      <datalist id="produtosList"></datalist>
    </main>
  </div>

  <script src="GestaoEvento.js"></script>
</body>
</html>
